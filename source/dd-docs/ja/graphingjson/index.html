

<!DOCTYPE html>
<html lang="en">
    <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <title>JSONを使用したグラフ表示入門</title>
    

    <meta itemprop="description" name="description" property="og:description" content="" />

    <link href="//fonts.googleapis.com/css?family=Open+Sans:700" rel="stylesheet" type="text/css">
    <link href="/static/css/bootstrap3-cbdde23cd71.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/tipuesearch.css">
    <link href="/static/css/style-cba6fad8d5d.css" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="/static/pygments.css" media="screen">


    <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>


    <script type="text/javascript">

      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-21102638-5']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

    </script>
    <script src="https://use.fontawesome.com/700fac0342.js"></script>
    
  </head>

  <body>
    <!-- HEADER -->
<div class="navbar navbar-static-top">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#topmenu" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand " href="/ja/">
        <img src="/static/dd_docs_logo.png">
      </a>
    </div>
    <div class="collapse navbar-collapse" id="topmenu">
      <ul class="nav navbar-nav navbar-right">
        <li class="dropdown">
          <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">ガイド <span class="caret"></span></a>
          <ul class="dropdown-menu">
          
            
              <li>
                <a href="/ja/overview/">Datadogが提供するサービスの概要</a>
              </li>
              
              <li>
                <a href="/ja/guides/basic_agent_usage/">Datadog Agent 入門</a>
              </li>
              
              <li>
                <a href="/ja/guides/metrics/">DogStatsD を使った、メトリクスの送信</a>
              </li>
              
              <li>
                <a href="/ja/guides/logs/">Datadog Agent によるログの解析方法</a>
              </li>
              
              <li>
                <a href="/ja/guides/hostmap/">Host Map表示の入門</a>
              </li>
              
              <li>
                <a href="/ja/guides/agent_checks/">Agent Checkの書き方</a>
              </li>
              
              <li>
                <a href="/ja/guides/azure/">Azure WindowsへDatadog Agentのインストール</a>
              </li>
              
              <li>
                <a href="/ja/guides/monitors/">Monitor(監視)機能の設定ガイド</a>
              </li>
              
              <li>
                <a href="/ja/guides/templating/">ダッシュボードのテンプレートの作成方法</a>
              </li>
              
              <li>
                <a href="/ja/guides/eventsemail/">メールによるイベント情報の送信</a>
              </li>
              
          </ul>
        </li>
        <li class="dropdown">
          <a id="nav-reference-dropdown" href="#" role="button" class="dropdown-toggle" data-toggle="dropdown">レファレンス <b class="caret"></b></a>
          <ul class="dropdown-menu dropdown-menu-left" role="menu" aria-labelledby="nav-guide-dropdown">
            <li><a href="/ja/api/">APIレファレンス</a></li>
            <li><a href="/ja/tracing/">Tracing (APM)</a></li>
            <li><a href="/ja/libraries/">APIライブラリー</a></li>
            <li><a href="/ja/monitoring/">アラート設定</a></li>
            <li><a href="/ja/graphing/">グラフ表示入門</a></li>
            <li><a href="/graphingjson/">JSONを使ったグラフの設定</a></li>
            <li><a href="/ja/hostnames/">ホスト名について</a></li>
            <li><a href="/ja/integrations/">インテグレーション</a></li>
            <li><a href="/ja/guides/dogstatsd/">DogStatsDの解説</a></li>
            <li><a href="/ja/examples/">サンプルコード</a></li>
            <li><a href="/ja/videos/">ビデオ</a></li>
            <li><a href="/ja/guides/billing/">課金に関するFAQ</a></li>
            <li><a href="/ja/faq/">FAQ</a></li>
          </ul>
        </li>
        
        <li><a href="/ja/help/">お問い合わせ</a></li>
        <li id="signin">
          <a class="btn navbar-btn flexbutton blueflex" href="https://app.datadoghq.com/signup">無料体験</a>
        </li>
        <li id="signup">
          <a class="btn navbar-btn flexbutton" href="https://help.datadoghq.com/hc/en-us/signin?return_to=https%3A%2F%2Fhelp.datadoghq.com%2Fhc%2Fen-us&locale=1">サポートログイン</a>
        </li>
      </ul>
    </div>
  </div>
</div>
<!-- END HEADER -->

    <div class="container">
      <div class="row">
      
        <!-- SIDEBAR -->
        <div class="col-sm-3 col-md-3 hidden-xs hidden-print" id="sidebarcolumn">
          <ul class="nav nav-tabs nav-stacked sidebar">
          
            <li class='nav-header'>Table of Contents</li><li><a style='' href='#graphing' onclick="$('#').collapse('show')">
JSONエディターを使用したグラフ表示</a></li><li><a style='padding: 5px 25px;' href='#grammar' onclick="$('#').collapse('show')">
JSON書式の構文</a></li><li><a style='' href='#requests' onclick="$('#').collapse('show')">
Requests (メトリクスの時系列データ, Series)</a></li><li><a style='padding: 3px 35px;font-size:13px;' href='#functions' onclick="$('#').collapse('show')">
関数</a></li><li><a style='padding: 3px 35px;font-size:13px;' href='#aggregation' onclick="$('#').collapse('show')">
データポイントの集計</a></li><li><a style='padding: 3px 35px;font-size:13px;' href='#metrics' onclick="$('#').collapse('show')">
メトリクスの確認</a></li><li><a style='padding: 3px 35px;font-size:13px;' href='#scope' onclick="$('#').collapse('show')">
対象範囲の指定(Scope, スコープ)</a></li><li><a style='padding: 3px 35px;font-size:13px;' href='#groups' onclick="$('#').collapse('show')">
グループの指定</a></li><li><a style='padding: 3px 35px;font-size:13px;' href='#math' onclick="$('#').collapse('show')">
演算子の利用</a></li><li><a style='padding: 5px 25px;' href='#events' onclick="$('#').collapse('show')">
イベントの表示</a></li><li><a style='padding: 5px 25px;' href='#viz' onclick="$('#').collapse('show')">
グラフによる可視化</a></li><li><a style='padding: 3px 35px;font-size:13px;' href='#linecharts' onclick="$('#').collapse('show')">
折れ線グラフ</a></li><li><a style='padding: 3px 35px;font-size:13px;' href='#stacked' onclick="$('#').collapse('show')">
積み上げグラフ</a></li><li><a style='padding: 3px 35px;font-size:13px;' href='#slice' onclick="$('#').collapse('show')">
Slice-n-Stack</a></li><li><a style='padding: 5px 25px;' href='#yaxis' onclick="$('#').collapse('show')">
Y軸の操作</a></li><li><a style='padding: 3px 35px;font-size:13px;' href='#filter' onclick="$('#').collapse('show')">
Y軸のフィルタリング</a></li><li><a style='padding: 3px 35px;font-size:13px;' href='#examples' onclick="$('#').collapse('show')">
設定例</a></li>
            
            
              <li class="nav-header">ガイド </li>
              
              
                <li><a href="/ja/overview/">Datadogが提供するサービスの概要</a></li>
              
                <li><a href="/ja/guides/basic_agent_usage/">Datadog Agent 入門</a></li>
              
                <li><a href="/ja/guides/metrics/">DogStatsD を使った、メトリクスの送信</a></li>
              
                <li><a href="/ja/guides/logs/">Datadog Agent によるログの解析方法</a></li>
              
                <li><a href="/ja/guides/hostmap/">Host Map表示の入門</a></li>
              
                <li><a href="/ja/guides/agent_checks/">Agent Checkの書き方</a></li>
              
                <li><a href="/ja/guides/azure/">Azure WindowsへDatadog Agentのインストール</a></li>
              
                <li><a href="/ja/guides/monitors/">Monitor(監視)機能の設定ガイド</a></li>
              
                <li><a href="/ja/guides/templating/">ダッシュボードのテンプレートの作成方法</a></li>
              
                <li><a href="/ja/guides/eventsemail/">メールによるイベント情報の送信</a></li>
              
            
          </ul>
        &nbsp;
        </div>
        <!-- END SIDEBAR -->
        
        <!-- MAIN -->
        <div class="col-xs-12 col-sm-9 col-md-9 main">
          <!-- PAGE TITLE -->
          
          <h1 id="pagetitle">JSONを使用したグラフ表示入門 </h1>
          
          
          <!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN" "http://www.w3.org/TR/REC-html40/loose.dtd">
<!--
There are two ways to interact with the Graphing Editor: using the GUI (the default method) and writing JSON (the more complete method). This page covers using JSON. To learn more about the GUI editor, visit the main [Graphing Primer Page](/graphing)
## Graphing with the JSON editor
{: #graphing}
--><html><body>
<p>グラフエディターの設定には、GUI(デフォルトの手法)とJSONの記述(より完全な手法)の2種類があります。このページではJSON形式を使用した手法について解説します。GUIでの設定については、<a href="/ja/graphing">グラフ表示入門</a>を参照して下さい。</p>

<h2 id="graphing" class="linked-header">
<a class="header-link" href="#graphing"><i class="fa fa-link"></i></a>JSONエディターを使用したグラフ表示</h2>

<p><img src="/static/images/references-graphing-jsoneditor.png" alt="JSON Editor"></p>

<!--### Grammar-->

<h3 id="grammar" class="linked-header">
<a class="header-link" href="#grammar"><i class="fa fa-link"></i></a>JSON書式の構文</h3>

<!--
The graph definition language is well-formed JSON and is structured in four parts:

1. Requests
2. Events
3. Visualization
4. Y Axis

Here is how they fit together in a JSON dictionary:
-->

<p>グラフを定義する言語は、JSON形式を採用し、次の4つの要素で構成されています:</p>

<ol>
  <li>Requests (メトリクスの時系列データ(Series)のクエリ)</li>
  <li>Events (イベントのクエリ)</li>
  <li>Visualization (timeseries;時系列データの折れ線グラフやheatmap;ヒートマップなどグラフ形式の指定)</li>
  <li>Y Axis (Y軸の範囲やフィルタ、線形や対数などスケールの指定)</li>
</ol>

<p>以下はこれらの要素が、1つのJSON書式で表現された例です:</p>

<pre><code>{
  "requests": [
    {
      "q": "metric{scope}"
    }
  ],
  "events": [
    {
      "q": "search query"
    }
  ],
  "viz": "visualization type",
  "yaxis": {
    "yaxisoptionkey": "yaxisoptionvalue"
  }
}
</code></pre>

<!--
In other words at the highest level the JSON structure is a dictionary with two, three, or four entries:

1. "requests" *
2. "events"
3. "viz" *
4. "yaxis"

\* *only requests and viz are required.*
-->

<p>JSON書式の一番外側のカッコ内に、先の要素が下記のエントリーとして記述されています:</p>

<ol>
  <li>“requests” *</li>
  <li>“events”</li>
  <li>“viz” *</li>
  <li>“yaxis”</li>
</ol>

<p>* <em>“requests”と”viz”は必ず指定する必要があります。</em></p>

<!--## Requests-->

<h2 id="requests" class="linked-header">
<a class="header-link" href="#requests"><i class="fa fa-link"></i></a>Requests (メトリクスの時系列データ, Series)</h2>
<!--
The general format for a series is:

    "requests": [
        {
          "q": "function(aggregation method:metric{scope} [by {group}])"
        }
    ]

The `function` and `group` are optional.

A Series can be further combined together via binary operators (+, -, /, *):

    metric{scope} [by {group}] operator metric{scope} [by {group}]
-->

<p>時系列データのクエリは、次のフォーマットになります:</p>

<pre><code>"requests": [
    {
      "q": "function(aggregation method:metric{scope} [by {group}])"
    }
]
</code></pre>

<p><code>function</code>と<code>group</code>の部分は、省略することができます。</p>

<p>時系列データは、バイナリー演算子(+, -, /, *)を使うことで、組み合わせて表示することができるようになります:</p>

<pre><code>metric{scope} [by {group}] operator metric{scope} [by {group}]
</code></pre>

<!--#### Functions-->

<h4 id="functions" class="linked-header">
<a class="header-link" href="#functions"><i class="fa fa-link"></i></a>関数</h4>

<!--
You can apply functions to the result of each query.

A few of these functions have been further explained in a series of examples. Visit this page for more detail: <a href="/examples/graphing functions/">Examples</a>
-->
<p>それぞれのクエリの結果に対して関数を適用することができます。</p>

<p>これらの関数のうち、いくつかについては具体的な設定例を用いた解説があります。こちらも併せて参照して下さい: <a href="/examples/graphing%20functions/">Examples for Graphing Functions</a>
本ドキュメントの最後にもいくつかの具体的な<a href="#examples">”設定例”</a>があります。</p>

<table class="table">
  <thead>
    <tr>
      <th>Function</th>
      <th>Category</th>
      <th>Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><code>abs()</code></td>
      <td>Arithmetic</td>
      <td>absolute value</td>
    </tr>
    <tr>
      <td><code>log2()</code></td>
      <td>Arithmetic</td>
      <td>base-2 logarithm</td>
    </tr>
    <tr>
      <td><code>log10()</code></td>
      <td>Arithmetic</td>
      <td>base-10 logarithm</td>
    </tr>
    <tr>
      <td><code>cumsum()</code></td>
      <td>Arithmetic</td>
      <td>cumulative sum over visible time window</td>
    </tr>
    <tr>
      <td><code>integral()</code></td>
      <td>Arithmetic</td>
      <td>cumulative sum of ([time delta] x [value delta]) over all consecutive pairs of points in the visible time window</td>
    </tr>
    <tr>
      <td><code>.fill()</code></td>
      <td>Interpolation</td>
      <td>choose how to interpolate missing values</td>
    </tr>
    <tr>
      <td><code>hour_before()</code></td>
      <td>Timeshift</td>
      <td>metric values from one hour ago</td>
    </tr>
    <tr>
      <td><code>day_before()</code></td>
      <td>Timeshift</td>
      <td>metric values from one day ago</td>
    </tr>
    <tr>
      <td><code>week_before()</code></td>
      <td>Timeshift</td>
      <td>metric values from one week ago</td>
    </tr>
    <tr>
      <td><code>month_before()</code></td>
      <td>Timeshift</td>
      <td>metric values from one month ago</td>
    </tr>
    <tr>
      <td><code>per_second()</code></td>
      <td>Rate</td>
      <td>the rate at which the metric changes per second</td>
    </tr>
    <tr>
      <td><code>per_minute()</code></td>
      <td>Rate</td>
      <td>
<code>per_second()</code> * 60</td>
    </tr>
    <tr>
      <td><code>per_hour()</code></td>
      <td>Rate</td>
      <td>
<code>per_second()</code> * 3600</td>
    </tr>
    <tr>
      <td><code>dt()</code></td>
      <td>Rate</td>
      <td>time delta between points</td>
    </tr>
    <tr>
      <td><code>diff()</code></td>
      <td>Rate</td>
      <td>value delta between points</td>
    </tr>
    <tr>
      <td><code>derivative()</code></td>
      <td>Rate</td>
      <td>1st order derivative; <code>diff()</code> / <code>dt()</code>
</td>
    </tr>
    <tr>
      <td><code>ewma_3()</code></td>
      <td>Smoothing</td>
      <td>exponentially weighted moving average with a span of 3</td>
    </tr>
    <tr>
      <td><code>ewma_5()</code></td>
      <td>Smoothing</td>
      <td>EWMA with a span of 5</td>
    </tr>
    <tr>
      <td><code>ewma_10()</code></td>
      <td>Smoothing</td>
      <td>EWMA with a span of 10</td>
    </tr>
    <tr>
      <td><code>ewma_20()</code></td>
      <td>Smoothing</td>
      <td>EWMA with a span of 20</td>
    </tr>
    <tr>
      <td><code>median_3()</code></td>
      <td>Smoothing</td>
      <td>rolling median with a span of 3</td>
    </tr>
    <tr>
      <td><code>median_5()</code></td>
      <td>Smoothing</td>
      <td>rolling median with a span of 5</td>
    </tr>
    <tr>
      <td><code>median_7()</code></td>
      <td>Smoothing</td>
      <td>rolling median with a span of 7</td>
    </tr>
    <tr>
      <td><code>median_9()</code></td>
      <td>Smoothing</td>
      <td>rolling median with a span of 9</td>
    </tr>
    <tr>
      <td><code>.rollup()</code></td>
      <td>Rollup</td>
      <td>override default time aggregation type and time period; see the “Rollup” section below for details</td>
    </tr>
    <tr>
      <td><code>count_nonzero()</code></td>
      <td>Count</td>
      <td>count all the non-zero values</td>
    </tr>
    <tr>
      <td><code>count_not_null()</code></td>
      <td>Count</td>
      <td>count all the non-null values</td>
    </tr>
    <tr>
      <td><code>top()</code></td>
      <td>Rank</td>
      <td>select the top series responsive to a given query, according to some ranking method; see the “Top functions” section below for more details</td>
    </tr>
    <tr>
      <td><code>top_offset()</code></td>
      <td>Rank</td>
      <td>similar to <code>top()</code>, except with an additional offset parameter, which controls where in the ordered sequence of series the graphing starts. For example, an offset of 2 would start graphing at the number 3 ranked series, according to the chosen ranking metric.</td>
    </tr>
    <tr>
      <td><code>robust_trend()</code></td>
      <td>Regression</td>
      <td>fit a robust regression trend line using Huber loss; see the “Robust regression” section below for more details</td>
    </tr>
    <tr>
      <td><code>trend_line()</code></td>
      <td>Regression</td>
      <td>fit an ordinary least squares regression line through the metric values</td>
    </tr>
    <tr>
      <td><code>piecewise_constant()</code></td>
      <td>Regression</td>
      <td>approximate the metric with a piecewise function composed of constant-valued segments</td>
    </tr>
    <tr>
      <td><code>anomalies()</code></td>
      <td>Algorithms</td>
      <td>overlay a gray band showing the expected behavior of a series based on past behavior; see our <a href="/guides/anomalies">guide to anomaly detection</a>
</td>
    </tr>
    <tr>
      <td><code>outliers()</code></td>
      <td>Algorithms</td>
      <td>highlight outlier series; see our <a href="/guides/outliers">guide to outlier detection</a>
</td>
    </tr>
  </tbody>
</table>

<p><strong><code>.as_count()</code> &amp; <code>.as_rate()</code></strong></p>

<p>These functions are only intended for metrics submitted as rates or counters via statsd. These functions will have no effect for other metric types. For more on details about how to use <code>.as_count()</code> and <code>.as_rate()</code> please see <a href="https://www.datadoghq.com/blog/visualize-statsd-metrics-counts-graphing/">our blog post</a>.</p>

<p><strong>Rollup</strong></p>

<p><code>.rollup()</code> is recommended for expert users only. Appending this function to the end of a query allows you to control the number of raw points rolled up into a single point plotted on the graph. The function takes two parameters, method and time: <code>.rollup(method,time)</code></p>

<p>The method can be sum/min/max/count/avg and time is in seconds. You can use either one individually, or both together like <code>.rollup(sum,120)</code>. We impose a limit of 350 points per time range. For example, if you’re requesting <code>.rollup(20)</code> for a month-long window, we will return data at a rollup far greater than 20 seconds in order to prevent returning a gigantic number of points.</p>

<p><strong>Top functions</strong></p>

<ul>
  <li>a metric query string with some grouping, e.g. <code>avg:system.cpu.idle{*} by {host}</code>
</li>
  <li>the number of series to be displayed, as an integer.</li>
  <li>one of <code>'max'</code>, <code>'min'</code>, <code>'last'</code>, <code>'l2norm'</code>, or <code>'area'</code>.  <code>'area'</code> is the signed area under the curve being graphed, which can be negative.  <code>'l2norm'</code> uses the <a href="http://en.wikipedia.org/wiki/Norm_(mathematics)#p-norm">L2 Norm</a> of the time series, which is always positive, to rank the series.</li>
  <li>either <code>'desc'</code> (rank the results in descending order) or <code>'asc'</code> (ascending order).</li>
</ul>

<p>The <code>top()</code> method also has convenience functions of the following form, all of which take a single series list as input:</p>

<p><code>[top, bottom][5, 10, 15, 20]_[mean, min, max, last, area, l2norm]()</code></p>

<p>For example, <code>bottom10_min()</code> retrieves lowest-valued 10 series using the ‘min’ metric.</p>

<p><strong>Robust regression</strong></p>

<p>The most common type of linear regression – ordinary least squares (OLS) – can be heavily influenced by a small number of points with extreme values. Robust regression is an alternative method for fitting a regression line; it is not influenced as strongly by a small number of extreme values. As an example, see the following plot.</p>

<p><img src="/static/images/robust-trend.png" alt=""></p>

<p>The original metric is shown as a solid blue line. The purple dashed line is an OLS regression line, and the yellow dashed line is a robust regression line. The one short-lived spike in the metric leads to the OLS regression line trending upward, but the robust regression line ignores the spike and does a better job fitting the overall trend in the metric.</p>

<!--
There are also a few functions you can append to a query which we recommend for expert users only.
<p>
One of these is <code>.rollup()</code>. Appending this function allows you to control the
number of points rolled up into a single point. This function takes two parameters, method and time, like so:
<code>.rollup(method,time)</code>.

The method can be sum/min/max/count/avg and time is in seconds. You can use either one individually,
or both combined like <code>.rollup(sum,120)</code>. There are some checks on this,
though, because for a given time range we do not return more than 350 points. Thus if
you're requesting <code>.rollup(20)</code> where 20 is in seconds, and ask for a
month of data, we will be returning the points at a rollup of far greater than 20 seconds.
</p>

<code>.as_count()</code> and <code>.as_rate()</code> are two other expert-only functions,
which are only intended for metrics submitted in a certain way (for metadata types where
that is acceptable).  At present, for metrics submitted as rates or counters via statsd,
appending <code>.as_count()</code> or <code>.as_rate()</code> will function correctly.
For other metrics, including gauges submitted by statsd, <code>.as_count()</code> and
<code>.as_rate()</code> will have no effect.

We strongly recommend not using <code>.rollup()</code> and <code>.as_count()</code> within the same query.
We will also be building these functions fully into the graph editor in the near
future. For more on <code>.as_count()</code> please see our blog post
<a target="_blank" href="https://www.datadoghq.com/blog/visualize-statsd-metrics-counts-graphing/">here</a>.
-->

<p>この他にも、クエリ結果に適用する上級者向けの関数が幾つかあります。</p>

<p>上級者向けの関数の一つが<code>.rollup()</code>です。この関数をクエリに追記することで、複数のポイントを単一ポイントにまとめることができます。この関数は、”メソッド”と”時間”の2つのパラメータを引数に指定することができます。(例: <code>.rollup(method,time)</code>)</p>

<p>“メソッド”の部分には、sum/min/max/count/avgを指定することができます。”時間”は、秒単位で指定します。
“メソッド”と”時間”は、個別に指定(例: <code>.rollup(20)</code>)したり、両方を組み合わせて(例: <code>.rollup(sum,120)</code>)も指定できます。
この<code>.rollup()</code>には、チェック機構があります。
しかしDatadogのグラフでは表示する時間の範囲に基づき350のデータポイントまでしか保有していないので、期間指定を一ヶ月にした場合は、20秒間隔以上の精度でデータポイントが保有されているため、20秒でのロールアップ<code>.rollup(20)</code>は、機能しません。</p>

<p>特定の方法で提出されたメトリクスためのもう一つの上級者向け関数が、<code>.as_count（）</code>と<code>.as_rate（）</code> です。
現状、DogStatsDの”rate”, “counter”を使って送信したメトリクスには、<code>.as_count（）</code>と<code>.as_rate（）</code>を使うことができますが、”gauges”などのそれ以外のメトリクスでは機能しません。</p>

<p><code>.rollup()</code>と<code>.as_count（）</code>を同じクエリで使用しないでください。
また、将来的にはこれらの関数は、グラフエディターで簡単に操作できるようになる予定です(<code>.rollup()</code>は利用可能です)。
<code>as_count()</code>に関する詳しい情報は、<a href="https://www.datadoghq.com/blog/visualize-statsd-metrics-counts-graphing/">“Visualize StatsD metrics with Counts Graphing”</a>のブログを参照してください。</p>

<!-- #### Aggregation Method -->

<h4 id="aggregation" class="linked-header">
<a class="header-link" href="#aggregation"><i class="fa fa-link"></i></a>データポイントの集計</h4>

<!--
In most cases, the number of data points available outnumbers the maximum number that can be shown on screen. To overcome this, the data is aggregated using one of 4 available methods: average,  max, min, and sum.
-->
<p>多くの場合、利用可能なデータポイントの数は画面に表示可能なデータポイントの数を上回ります。これに対応するため、データポイントは4つの集計方法{average,  max, min, sum}の1つにより集計されています。</p>

<!-- #### Metrics -->

<h4 id="metrics" class="linked-header">
<a class="header-link" href="#metrics"><i class="fa fa-link"></i></a>メトリクスの確認</h4>

<!--
The metric is the main focus of the graph. You can find the list of metrics available to you in the [Metrics Summary](https://app.datadoghq.com/metric/summary). Click on any metric to see more detail about that metric, including the type of data collected, units, tags, hosts, and more.
-->
<p>メトリクスはグラフ表示の要です。現在利用可能なメトリクスは <a href="https://app.datadoghq.com/metric/summary">Metrics Summary</a> にてリスト表示することができます。各メトリクスをクリックしてそのメトリクスがどのようなデータを取得しているか、あるいはタグやホストなどの関連する詳しい情報を確認します。</p>

<!-- #### Scope -->

<h4 id="scope" class="linked-header">
<a class="header-link" href="#scope"><i class="fa fa-link"></i></a>対象範囲の指定(Scope, スコープ)</h4>

<!--
A scope lets you filter a Series. It can be a host, a device on a host
or any arbitrary tag you can think of that contains only alphanumeric
characters plus colons and underscores (`[a-zA-Z0-9:_]+`).

Examples of scope (meaning in parentheses):

    host:my_host                      (related to a given host)
    host:my_host, device:my_device    (related to a given device on a given host)
    source:my_source                  (related to a given source)
    my_tag                            (related to a tagged group of hosts)
    my:tag                            (same)
    *                                 (wildcard for everything)
-->

<p>スコープを指定することで時系列データの対象範囲を限定することができます。スコープでは、ホスト名やホスト上のデバイス、更に英数文字列 (<code>[a-zA-Z1-9:_]+</code>)のタグが付与された情報を指定することができます。</p>

<p>範囲指定の例 (カッコ内は、対象範囲の解説):</p>

<pre><code>host:my_host                      (指定されたホスト名に関連した情報)
host:my_host, device:my_device    (指定されたホスト名の指定されたデバイスに関連した情報)
source:my_source                  (指定された情報ソースに関連した情報)
my_tag                            (my_tagで指定されたグループに関連する情報)
my:tag                            (同上)
*                                 (ワイルドカード)
</code></pre>

<!-- #### Groups -->

<h4 id="groups" class="linked-header">
<a class="header-link" href="#groups"><i class="fa fa-link"></i></a>グループの指定</h4>

<!--
For any given metric, data may come from a number of hosts. The data will normally be aggregated from all these hosts to a single value for each time slot. If you wish to split this out, you can by any tag. To include a data point seperated out by each host,  use {host} for your group.
-->
<p>どのメトリクスにおいても、複数のホストからのデータによって構成され得ています。そうしたデータは通常、時間間隔ごとにすべてのホストからのデータが単一の値に集計されますが、あらゆるタグによってデータを分離して取得することができます。あるメトリクスに対してホストごとにデータポイントを分けて見たい場合、{host}グループの指定を行います。</p>

<!-- #### Arithmetic -->

<h4 id="math" class="linked-header">
<a class="header-link" href="#math"><i class="fa fa-link"></i></a>演算子の利用</h4>

<!--
You can apply simple arithmetic to a Series (+, -, * and /). In this
example we graph 5-minute load and its double:

    {
      "viz": "timeseries",
      "requests": [
        {
          "q": "system.load.5{intake} * 2"
        },
        {
          "q": "system.load.5{intake}"
        }
      ]
    }

You can also add, substract, multiply and divide a Series. Beware that
Datadog does not enforce consistency at this point so you *can* divide
apples by oranges.

    {
        "viz": "timeseries",
        "requests": [
          {
            "q": "metric{apples} / metric{oranges}"
          }
        ]
    }
-->

<p>時系列データには、簡単な演算( +, -, *, / )を適用することができます。
次の例では、5分間のload averageの値とその倍の数値をグラフ表示することにします:</p>

<pre><code>{
  "viz": "timeseries",
  "requests": [
    {
      "q": "system.load.5{intake} * 2"
    },
    {
      "q": "system.load.5{intake}"
    }
  ]
}
</code></pre>

<p>時系列データ同士を、加算 減算 乗算 除算することもできます。
Datadogでは、ここでは一貫性を強制していないので、<em>異なるものの除算をすることもできます</em>。</p>

<pre><code>{
    "viz": "timeseries",
    "requests": [
      {
        "q": "metric{apples} / metric{oranges}"
      }
    ]
}
</code></pre>

<!-- ### Events -->

<h3 id="events" class="linked-header">
<a class="header-link" href="#events"><i class="fa fa-link"></i></a>イベントの表示</h3>

<!--
You can overlay any event from Datadog. The general format is:

    "events": [
      {
        "q": "search query"
      }
    ]

For instance, to indicate that you want events for host X and tag Y:

    "events": [
      {
        "q": "host:X tags:Y"
      }
    ]

or if you're looking to display all errors:

    "events": [
      {
        "q": "status:error"
      }
    ]
-->

<p>Datadogに保存したイベント情報は、次の書式で記述することでグラフにオーバーレイすることができます:</p>

<pre><code>"events": [
  {
    "q": "search query"
  }
]
</code></pre>

<p>例えば、ホスト”X”のタグ”Y”が付いたイベントをオーバーレイする場合は:</p>

<pre><code>"events": [
  {
    "q": "host:X tags:Y"
  }
]
</code></pre>

<p>エラーにステータスをオーバーレイする場合は:</p>

<pre><code>"events": [
  {
    "q": "status:error"
  }
]
</code></pre>

<h3 id="viz" class="linked-header">
<a class="header-link" href="#viz"><i class="fa fa-link"></i></a>グラフによる可視化</h3>

<!--
Data can be visualized in a few different ways:

1. Time Series
2. Heatmap
3. Distribution
4. Toplist
5. Change
6. Hostmap

The Time Series can be further broken down to:

1. as line charts
2. as stacked areas
3. as slice-n-stack areas
4. as bar charts
-->

<p>データポイントを可視化するグラフ形式にはいくつかの種類があります:</p>

<ol>
  <li>Time Series (時系列データのグラフ)</li>
  <li>Heatmap (ヒートマップ, 指定したスコープ内でのメトリクスの時系列分布)</li>
  <li>Distribution (分布図, 指定したスコープ内での特定の時間枠のメトリクスの分布)</li>
  <li>Toplist (トップリスト, 指定したスコープ内でのメトリクスのランキング)</li>
  <li>Change (チェンジグラフ, 一定時間前とのメトリクスの変化量を示すグラフ)</li>
  <li>Hostmap (ホストマップ)</li>
</ol>

<p>さらに、Time Series (時系列データのグラフ)では下記のグラフ形式が選択できます:</p>

<ol>
  <li>折れ線グラフ</li>
  <li>積み上げグラフ</li>
  <li>slice-n-stackグラフ</li>
  <li>棒グラフ</li>
</ol>

<!-- #### Line Charts -->

<h4 id="linecharts" class="linked-header">
<a class="header-link" href="#linecharts"><i class="fa fa-link"></i></a>折れ線グラフ</h4>

<p><img src="/static/images/multi-lines.png" style="width:100%; border:1px solid #777777"></p>

<!-- The representation is automatically derived from having multiple `requests` values. -->
<p>このグラフ表現は、<code>requests</code>部に複数の検索クエリを有する場合に自動的に設定されます。</p>

<pre><code>"requests": [
    {
      "q": "metric1{scope}"
    },
    {
      "q": "metric2{scope}"
    },
    {
      "q": "metric3{scope}"
    }
  ]
</code></pre>

<p>これにより、複数の時系列データのグラフを重ね合わせて表示することができます。</p>

<!-- #### Stacked Series -->

<h4 id="stacked" class="linked-header">
<a class="header-link" href="#stacked"><i class="fa fa-link"></i></a>積み上げグラフ</h4>

<p><img src="/static/images/slice-n-stack.png" style="width:100%; border:1px solid #777777"></p>

<!-- In the case of related Time Series, you can easily draw them as stacked areas by using the following syntax: -->
<p>関連している時系列データの場合は、次の構文を記述し積み上げグラフを表示することができます:</p>

<pre><code>"requests": [
    {
      "q": "metric1{scope}, metric2{scope}, metric3{scope}"
    }
]
</code></pre>

<!-- Instead of one query per chart you can aggregate all queries into one and simply concatenate the queries. -->
<p>チャート毎に1つのクエリを表示する代わりに”,”ですべてのクエリを連結することによって、全てのクエリを1つのグラフに積み上げて表示することができます。</p>

<h4 id="slice" class="linked-header">
<a class="header-link" href="#slice"><i class="fa fa-link"></i></a>Slice-n-Stack</h4>

<!--
A useful visualization is to represent a metric shared across
hosts and stack the results. For instance, when selecting a tag that
applies to more than 1 host you will see that ingress and egress
traffic is nicely stacked to give you the sum as well as the split per
host. This is useful to spot wild swings in the distribution of network
traffic.

Here's how to do it for any metric:
-->
<p>異なるホストにまたがるメトリクスを積み上げた結果のグラフが有益な場合もあります。例えば、複数のホストに共通して付されているタグを選択し、それらのホストのネットワークトラフィックの出入りをホスト毎に積み上げたグラフを見てみたいとします。このようなグラフは、ネットワークトラフィックの中で異常が発生していることを発見するのに便利です。</p>

<p>この例は、次のように記述します:</p>

<pre><code>"requests" [
  {
     "q": "system.net.bytes_rcvd{some_tag, device:eth0} by {host}"
  }
]
</code></pre>

<!--
Note that in this case you can only have 1 query. But you can also split by device, or a combination of both:
-->
<p>このケースでは、クエリは1つしか発行できないことに注目してください。
しかしながら、デバイス単位やホストとデバイスの組み合わせを基準としてスライスすることもできます:</p>

<pre><code>"requests" [
  {
     "q": "system.net.bytes_rcvd{some_tag} by {host,device}"
  }
]
</code></pre>

<!--to get traffic for all the tagged hosts, split by host and network device.-->
<p>全てのタグ付けされたホストから、ホストとネットワークデバイスでスライスし、積み上げたグラフを表示します。</p>

<!-- ### Y-Axis Controls -->

<h3 id="yaxis" class="linked-header">
<a class="header-link" href="#yaxis"><i class="fa fa-link"></i></a>Y軸の操作</h3>

<!--
The Datadog y-axis controls (currently just via the JSON editor) allow you to:
<ul>
 <li>Clip y-axis to specific ranges</li>
 <li>Filter series either by specifying a percentage or an absolute value</li>
 <li>Change y-axis scale from linear to log, sqrt or power scale</li>
</ul>

There are three configuration settings:
<ul>
<li><code>min</code> (optional): Specifies minimum value to show on y-axis. It takes a number, or "auto" for
    default behvior. Default value is "auto"</li>
<li><code>max</code> (optional): Specifies the maximum value to show on y-axis. It takes a number, or "auto"
    for default behavior. Default value is "auto"</li>
<li><code>scale</code> (optional): Specifies the scale type. Possible values: "linear", "log", "sqrt", "pow##"
    (eg. pow2, pow0.5, 2 is used if only "pow" was provided"), Default scale is "linear".</li>
</ul>
-->

<p>グラフエディターからJSONを編集することで次のようなY軸の制御ができます(現時点ではJSONエディターのみの機能):</p>
<ul>
 <li>Y軸の表示範囲の指定</li>
 <li>パーセンテージか絶対値のいずれかを指定することより時系列データをフィルタ</li>
 <li>Y軸の目盛りを線形スケールから対数スケールや指数スケールへ変更</li>
</ul>

<p>Y軸を設定するために次の3のオプションがあります:</p>

<ul>
  <li>
<code>min</code> (オプション): Y軸に表示する最小値を指定します。 ここでは、数値か”auto”を指定することができます。デフォルト値は、”auto”です。</li>
  <li>
<code>max</code> (オプション): Y軸に表示する最大値を指定します。 ここでは、数値か”auto”を指定することができます。デフォルト値は、”auto”です。</li>
  <li>
<code>scale</code> (オプション): Y軸の目盛りのタイプを指定します。 指定できる値は、”linear”, “log”, “sqrt”, “pow##”(例. pow2, pow0.5)です。デフォルト値は、”linear”です。</li>
</ul>

<p>Examples:</p>

<pre><code>"yaxis": {
    "min": "auto",
    "max": 200,
    "scale": "log"
}

"yaxis": {
    "min": 200,
    "scale": "sqrt"
}

"yaxis": {
    "min": 9000,
    "max": 10000
}

"yaxis": {
    "scale": "pow0.1"
}

"yaxis": {
    "scale": "pow3"
}
</code></pre>

<!-- #### Filtering -->

<h4 id="filter" class="linked-header">
<a class="header-link" href="#filter"><i class="fa fa-link"></i></a>Y軸のフィルタリング</h4>

<!--
Filter configuration allows you to automatically change y-axis bounds based on a
threshold. Thresholds can be a percentage or an absolute value, and it can apply to
both both ends of the graph (lower and upper).

For y-axis filtering, there are two ways to set up the configuration.

To begin, there is a simple configuration where you specify an absolute value or a percentage and all
values above the value or all values that sit within the top ##% will be cutoff.
-->

<p>Y軸にフィルタリングの閾値を定義することにより、Y軸の上下限を自動的に変更することができます。
閾値には、パーセンテージまたは絶対値を指定することができます。
この閾値は、グラフの上限と下限の両方に設定することができます。</p>

<p>Y軸のフィルタリングの定義には、2つの設定方法があります。</p>

<p>1つは、絶対値を指定しその値を超えているメトリクスの値をフィルタして除去する方法です。もう一方は、パーセンテージを指定し、トップから指定したパーセンテージまでの値をフィルタして除去する方法です。</p>

<p>Examples:</p>

<pre><code>"yaxis": {
    "filter": 30 // 値が30以上のデータポイントは除去され、表示されません
}

"yaxis": {
    "filter": "5%" // 上位5%の値をもったデータポイントは除去され、表示されません
}
</code></pre>

<!--
Advanced configuration works the same way as simple configuration, with the added
flexibility of configuring the lower or the upper or both parts of the graph. For
example, the following configuration will limit the graph to data points that are
not in the bottom 10% nor in the top 30%.
-->

<p>高度な設定も、シンプルな設定ど同じような概念で進めることができます。
高度な設定では、グラフの下限,上限,その両方の設定がより柔軟にコントロールできるようになっています。
例えば、次のグラフ設定では、下限10%以上で、上限30%以下のデータポイントのみグラフ表示されるようにフィルタしています。</p>

<pre><code>"yaxis": {
    "filter": {
        "top": "30%",
        "bottom": "10%"
    }
}
</code></pre>

<!-- The following will show all data except those with values higher than 15: -->
<p>次は、値が15以上のデータポイント除去します:</p>

<pre><code>"yaxis": {
    "filter": {
        "above": 15
    }
}
</code></pre>

<!-- The following will hide data points below 2: -->
<p>次は、値が2以下のデータポイント除去します:</p>

<pre><code>"yaxis": {
    "filter": {
        "below": 2
    }
}
</code></pre>

<!-- Here is a full JSON example: -->
<p>すべての要素を含んだJSON表記の例です:</p>

<pre><code>{
  "viz": "timeseries",
  "requests": [
    {
      "q": "system.cpu.idle{host:hostname}",
      "stacked": false
    }
  ],
  "events": [],
  "yaxis": {
    "scale": "log"
    "filter": {
         "top": "5%",
         "below": 15
     }
  },
}
</code></pre>

<!-- #### Examples -->

<h4 id="examples" class="linked-header">
<a class="header-link" href="#examples"><i class="fa fa-link"></i></a>設定例</h4>

<!--
Here is an example using the <code>rate()</code> function, which takes only a single metric as a parameter.  Other functions, with the exception of <code>top()</code> and <code>top_offset()</code>, have identical syntax.
-->
<p>パラメーターに１つのメトリクスを指定した<code>rate()</code>関数を使った例です。<code>top()</code>と<code>top_offset()</code>以外の関数では、この<code>rate()</code>と同様のシンタックス表記を利用することできます。</p>

<pre><code>{
  "viz": "timeseries",
  "requests": [
    {
      "q": "rate(sum:system.load.5{role:intake-backend2} by {host})",
      "stacked": false
    }
  ]
}
</code></pre>

<!-- Here is an example using the <code>top()</code> function: -->
<p><code>top()</code> 関数を使用した例:</p>

<pre><code>{
  "viz": "timeseries",
  "requests": [
    {
      "q": "top(avg:system.cpu.iowait{*} by {host}, 5, 'max', 'desc')",
      "stacked": false
    }
  ]
}
</code></pre>

<!--
This will show the graphs for the five series with the highest peak <code>system.cpu.iowait</code> values in the query window.

To look at the hosts with the 6th through 10th highest values (for example), use <code>top_offset</code> instead:
-->

<p>この例では、<code>system.cpu.iowait</code>のピーク値の上位5位をグラフに表示します。</p>

<p><code>system.cpu.iowait</code>のピーク値ランキングの第6位から10位のホストを表示するためには、<code>top_offset</code>を使います:</p>

<pre><code>{
  "viz": "timeseries",
  "requests": [
    {
      "q": "top_offset(avg:system.cpu.iowait{*} by {host}, 5, 'max', 'desc', 5)",
      "stacked": false
    }
  ]
}
</code></pre>

<!-- Here is an example using the <code>week_before()</code> function: -->
<p><code>week_before()</code>関数を使用した例:</p>

<pre><code>{
  "viz": "timeseries",
  "requests": [
    {
      "q": "sum:haproxy.count_per_status{status:available} - week_before(sum:haproxy.count_per_status{status:available})"
    }
  ]
}
</code></pre>
</body></html>


          
        </div>
      </div>
    </div>
    <div class="container">
  <div class="row" id="footer">
    <div class=".col-md-12">お困りの場合は、 <a href="/ja/help/">お気軽にお声がけ下さい。</a> &bull; ドキュメント内の不備を見つけた場合は、 <a href="https://github.com/DataDog/documentation/issues">ご連絡を頂けると助かります。</a></div>
    <div class=".col-md-12"><a href="/">Read the docs in English</a></div>
    <div class=".col-md-12">&copy; Datadog, Inc. All rights reserved.</div>
  </div>
</div>

    

        <script type="text/javascript">
      ;(function(p,l,o,w,i,n,g){if(!p[i]){p.GlobalSnowplowNamespace=p.GlobalSnowplowNamespace||[];
      p.GlobalSnowplowNamespace.push(i);p[i]=function(){(p[i].q=p[i].q||[]).push(arguments)
      };p[i].q=p[i].q||[];n=l.createElement(o);g=l.getElementsByTagName(o)[0];n.async=1;
      n.src=w;g.parentNode.insertBefore(n,g)}}(window,document,"script","https://don08600y3gfm.cloudfront.net/ps3b/static/js/plow232.js","snowplow"));
      window.snowplow('newTracker', 'co', 'collector.datadoghq.com', { // Initialise a tracker
      appId: 'datadog', // Application ID. Make sure you use the same value across all the tags you fire on your trial
      platform: 'web',
      cookieDomain: '.datadoghq.com',
      contexts: {
        performanceTiming: true,
        webPage: true
        }
      });
      window.snowplow('enableActivityTracking', 5, 5); // Ping every 30 seconds after 30 seconds
      window.snowplow('enableLinkClickTracking');
      window.snowplow('trackPageView');
    </script>

        <script type="text/javascript">
      (function() {
       var didInit = false;
       function initMunchkin() {
         if(didInit === false) {
           didInit = true;
           Munchkin.init('875-UVY-685');
         }
       }
       var s = document.createElement('script');
       s.type = 'text/javascript';
       s.async = true;
       s.src = '//munchkin.marketo.net/munchkin.js';
       s.onreadystatechange = function() {
         if (this.readyState == 'complete' || this.readyState == 'loaded') {
           initMunchkin();
         }
       };
       s.onload = initMunchkin;
       document.getElementsByTagName('head')[0].appendChild(s);
      })();
    </script>


    <!-- <script src="/static/jquery-1.7.2.min.js"></script> -->
<script src="/static/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="/tipuesearch/tipuesearch-set.js"></script>
<script type="text/javascript" src="/tipuesearch/tipuesearch_content.js"></script>
<script type="text/javascript" src="/tipuesearch/tipuesearch.js"></script>
<script src="/static/datadog-docs.js"></script>


    <!-- No page Javascript -->
  </body>
</html>


